<html>
    <head>
        <link rel="preconnect" href="http://fonts.gstatic.com">
        <link href="http://fonts.googleapis.com/css2?family=Poppins:wght@400;500&display=swap" rel="stylesheet">
        <style>
            /* 960 Grid System */
            /**
             * Generated with https://github.com/trungdq88/960-grid-generator
             * Columns number: 12 column(s)
             * Column width: 44px
             * Column space: 10px
             *
             * Content width: 638px
             * Full width: 648px
             */

            body {
                display: block;
                margin: 0 auto;
                min-width: 648px;
                font-size: 13px;
            }
            .container_12 {
                margin-left: auto;
                margin-right: auto;
                width: 648px;
                overflow: hidden;
            }
            .grid_1,
            .grid_2,
            .grid_3,
            .grid_4,
            .grid_5,
            .grid_6,
            .grid_7,
            .grid_8,
            .grid_9,
            .grid_10,
            .grid_11,
            .grid_12
            {
                display:inline;
                float: left;
                position: relative;
                margin-left: 5px;
                margin-right: 5px;
            }
            .push_1,.pull_1,
            .push_2,.pull_2,
            .push_3,.pull_3,
            .push_4,.pull_4,
            .push_5,.pull_5,
            .push_6,.pull_6,
            .push_7,.pull_7,
            .push_8,.pull_8,
            .push_9,.pull_9,
            .push_10,.pull_10,
            .push_11,.pull_11,
            .pull_12,.push_12
            {
                position:relative;
            }
            .alpha {
                margin-left: 0;
            }
            .omega {
                margin-right: 0;
            }
            .container_12 .grid_1 {
                width: 44px
            }
            .container_12 .grid_2 {
                width: 98px
            }
            .container_12 .grid_3 {
                width: 152px
            }
            .container_12 .grid_4 {
                width: 206px
            }
            .container_12 .grid_5 {
                width: 260px
            }
            .container_12 .grid_6 {
                width: 314px
            }
            .container_12 .grid_7 {
                width: 368px
            }
            .container_12 .grid_8 {
                width: 422px
            }
            .container_12 .grid_9 {
                width: 476px
            }
            .container_12 .grid_10 {
                width: 530px
            }
            .container_12 .grid_11 {
                width: 584px
            }
            .container_12 .grid_12 {
                width: 638px
            }
            .container_12 .prefix_1 {
                padding-left: 54px
            }
            .container_12 .prefix_2 {
                padding-left: 108px
            }
            .container_12 .prefix_3 {
                padding-left: 162px
            }
            .container_12 .prefix_4 {
                padding-left: 216px
            }
            .container_12 .prefix_5 {
                padding-left: 270px
            }
            .container_12 .prefix_6 {
                padding-left: 324px
            }
            .container_12 .prefix_7 {
                padding-left: 378px
            }
            .container_12 .prefix_8 {
                padding-left: 432px
            }
            .container_12 .prefix_9 {
                padding-left: 486px
            }
            .container_12 .prefix_10 {
                padding-left: 540px
            }
            .container_12 .prefix_11 {
                padding-left: 594px
            }
            .container_12 .suffix_1 {
                padding-right: 54px
            }
            .container_12 .suffix_2 {
                padding-right: 108px
            }
            .container_12 .suffix_3 {
                padding-right: 162px
            }
            .container_12 .suffix_4 {
                padding-right: 216px
            }
            .container_12 .suffix_5 {
                padding-right: 270px
            }
            .container_12 .suffix_6 {
                padding-right: 324px
            }
            .container_12 .suffix_7 {
                padding-right: 378px
            }
            .container_12 .suffix_8 {
                padding-right: 432px
            }
            .container_12 .suffix_9 {
                padding-right: 486px
            }
            .container_12 .suffix_10 {
                padding-right: 540px
            }
            .container_12 .suffix_11 {
                padding-right: 594px
            }
            .container_12 .push_1 {
                left: 54px
            }
            .container_12 .push_2 {
                left: 108px
            }
            .container_12 .push_3 {
                left: 162px
            }
            .container_12 .push_4 {
                left: 216px
            }
            .container_12 .push_5 {
                left: 270px
            }
            .container_12 .push_6 {
                left: 324px
            }
            .container_12 .push_7 {
                left: 378px
            }
            .container_12 .push_8 {
                left: 432px
            }
            .container_12 .push_9 {
                left: 486px
            }
            .container_12 .push_10 {
                left: 540px
            }
            .container_12 .push_11 {
                left: 594px
            }
            .container_12 .pull_1 {
                left: -54px
            }
            .container_12 .pull_2 {
                left: -108px
            }
            .container_12 .pull_3 {
                left: -162px
            }
            .container_12 .pull_4 {
                left: -216px
            }
            .container_12 .pull_5 {
                left: -270px
            }
            .container_12 .pull_6 {
                left: -324px
            }
            .container_12 .pull_7 {
                left: -378px
            }
            .container_12 .pull_8 {
                left: -432px
            }
            .container_12 .pull_9 {
                left: -486px
            }
            .container_12 .pull_10 {
                left: -540px
            }
            .container_12 .pull_11 {
                left: -594px
            }

            /* Clear Floated Elements
            ----------------------------------------------------------------------------------------------------*/

            /* http://sonspring.com/journal/clearing-floats */

            .clear {
                clear: both;
                display: block;
                overflow: hidden;
                visibility: hidden;
                width: 0;
                height: 0;
            }

            /* http://www.yuiblog.com/blog/2010/09/27/clearfix-reloaded-overflowhidden-demystified */

            .clearfix:before,
            .clearfix:after {
                content: '\0020';
                display: block;
                overflow: hidden;
                visibility: hidden;
                width: 0;
                height: 0;
            }

            .clearfix:after {
                clear: both;
            }

            /*
              The following zoom:1 rule is specifically for IE6 + IE7.
              Move to separate stylesheet if invalid CSS is a problem.
            */

            .clearfix {
                zoom: 1;
            }
        </style>

        <style>
            /* Custom Styles */

            body {
                font-family: 'Poppins', sans-serif;
                font-weight: 400;
                color: #474747;
            }

            .w-full {
                width: 100%;
            }

            .fw-500 {
                font-weight: 500;
                color: #000000;
            }

            table, th, td {
                border-collapse: collapse;
                border: 1px solid  #dee2e6;
                width: 100%;
                text-align: left;
                font-size: 10px;
            }

            table thead th {
                padding: 8px 5px;
                width: auto;
                background-color: #f9f9f9;
            }

            table tbody th,
            table tbody td {
                padding: 5px;
                width: auto;
                word-break: break-all;
                max-width: 60px;
            }
            table th{
                word-break: break-all;
            }

            table tr {
                page-break-inside: avoid;
            }
            table{
                max-width: 100%;
                min-width: 100%;
            }
        </style>
    </head>

    <body style="display: block; margin: 0 auto; background: #ffffff;">
        <div class="pdf-body">
            <div>
                <div class="grid_12" style="margin-bottom: 10px;">
                    <h4>Invoice Records</h4>
                </div>

                <div class="grid_12">
                    <table>
                        <thead>
                            <tr>
                                @if(in_array('customer', $columns))<th style="min-width:30px;">Customer</th>@endif
                                @if(in_array('invoice_number', $columns))<th style="min-width:30px;">Invoice Number</th>@endif
                                @if(in_array('site', $columns))<th style="min-width:30px;">Site</th>@endif
                                @if(in_array('locations', $columns))<th style="min-width:30px;">Location(s)</th>@endif
                                @if(in_array('supplier', $columns))<th style="min-width:30px;">Supplier(s)</th>@endif
                                @if(in_array('invoice_date', $columns))<th style="min-width:50px;">Invoice Date</th>@endif
                                @if(in_array('contract_number', $columns))<th style="min-width:50px;">Order Number</th>@endif
                                @if(in_array('payment_method', $columns))<th style="min-width:50px;">Payment Method</th>@endif
                                @if(in_array('fld_type', $columns))<th style="min-width:50px;">Type</th>@endif
                            </tr>
                        </thead>

                        <tbody>
                            @if(!empty($invoiceData))
                                @foreach($invoiceData as $invoice)
                                    <tr>
                                    @if(in_array('customer', $columns))<td>{{ ($invoice->last_name && $invoice->first_name) ? (decodeHtml($invoice->first_name) .' '. decodeHtml($invoice->last_name)) : '-'}}</td>@endif
                                        @if(in_array('invoice_number', $columns))<td>{{$invoice->inv_number ? decodeHtml($invoice->inv_number): '-'}}</td>@endif
                                        @if(in_array('site', $columns))<td>{{$invoice->terr_name ? decodeHtml($invoice->terr_name): '-'}}</td>@endif
                                        @if(in_array('locations', $columns))
                                            <td>
                                                @if ($invoice->order->orderItems && sizeof($invoice->order->orderItems) > 0)
                                                    @php $locationNames = [];@endphp
                                                         @foreach (($invoice->order->orderItems) as $idx => $array)
                                                            @php
                                                                $location = '';
                                                                $location = isset($array['consumerOrderItemLocations'][0]) && isset($array['consumerOrderItemLocations'][0]['location']) && isset($array['consumerOrderItemLocations'][0]['location']['name']) ? $array['consumerOrderItemLocations'][0]['location']['name'] : '';
                                                                if ($location != '') {
                                                                    $locationNames[] = $location;
                                                                }
                                                            @endphp
                                                        @endforeach
                                                    @if ( $idx == sizeof($invoice->order->orderItems) -1  && sizeof($locationNames) > 0)
                                                        {{ implode(', ', array_unique($locationNames)) }}
                                                    @else
                                                        {{ '-' }}
                                                    @endif
                                                @else
                                                    {{ '-' }}
                                                @endif
                                            </td>
                                        @endif
                                        @if(in_array('supplier', $columns))<td>
                                                @if ($invoice->order->orderItems && sizeof($invoice->order->orderItems) > 0)
                                                    @php $supplierNames = [];@endphp
                                                    @foreach (($invoice->order->orderItems) as $idx => $array)
                                                        @php
                                                            $name = '';
                                                            $name = isset($array['supplier']) && isset($array['supplier']['tena_name']) && isset($array['supplier']['tena_name']) ? $array['supplier']['tena_name'] : '';
                                                            if ($name != '') {
                                                                $supplierNames[] = $name;
                                                            }
                                                        @endphp
                                                    @endforeach
                                                    @if ( $idx == sizeof($invoice->order->orderItems) -1  && sizeof($supplierNames) > 0)
                                                        {{ implode(', ', array_unique($supplierNames)) }}
                                                    @else
                                                        {{ '-' }}
                                                    @endif
                                                @else
                                                    {{ '-' }}
                                                @endif
                                            </td>@endif
                                        @if(in_array('invoice_date', $columns))<td>{{$invoice->inv_date ? \Carbon\Carbon::parse($invoice->inv_date)->format('d-M-Y'): '-'}}</td>@endif
                                        @if(in_array('contract_number', $columns))<td>{{$invoice->order_number ? decodeHtml($invoice->order_number): '-'}}</td>@endif
                                        @if(in_array('payment_method', $columns))
                                            @if($invoice->tran_type === 'WEB_PAYMENT')
                                                <td>{{decodeHtml('Web Payment')}}</td>
                                            @endif
                                            @if($invoice->tran_type === 'DEVICE_PAYMENT')
                                                <td>{{decodeHtml('Device Payment')}}</td>
                                            @endif
                                            @if($invoice->tran_type === 'ENDOWMENT')
                                                <td>{{decodeHtml('Endowment')}}</td>
                                            @endif
                                            @if($invoice->tran_type === 'CASH_CHEQUE_OTHER')
                                                <td>{{decodeHtml('Cash/Cheque/Other')}}</td>
                                            @endif
                                            @if($invoice->tran_type === 'REFUND')
                                                <td>{{decodeHtml('Refund')}}</td>
                                            @endif
                                        @endif
                                        @if(in_array('fld_type', $columns))
                                            @if($invoice->fld_type === 'CAMPAIGN')
                                                <td>{{decodeHtml('Floral Campaign')}}</td>
                                            @endif
                                            @if($invoice->fld_type === 'STORE')
                                                <td>{{decodeHtml('Floral Store')}}</td>
                                            @endif
                                    @endif

                                    </tr>
                                @endforeach
                            @endif
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </body>
</html>
